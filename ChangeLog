2005-06-21  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-eat-utt): Don't try to examine `token' if it
	is nil.

2005-06-13  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-next-chunk): Ensure index marks don't create
	utterance boundary.
	(ssml-join): New variable.
	(ssml-parse): Reset it.

	* events.scm (event-synth-plain): Support for `mark' event type
	added.
	(event-eat-utt): Process index marks.

	* tokenize.scm (token-utterance-append): New function.
	(get-regular-token, get-single-char-token): Use it.
	(append-token-utterances): New function.

2005-06-13  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-eat-utt): Omission in the segment event
	assignment fixed.

2004-12-05  Milan Zamazal  <pdm@zamazal.org>

	* tokenize.scm: Require spell-mode.
	(get-token): Renamed to get-regular-token.
	(get-single-char-token, get-token): New functions.

	* spell-mode.scm (spell-mode): New variable.
	(spell_init_func, spell_exit_func): Set it.

	* ssml-mode.scm : Require spell-mode.
	(ssml-say-as-settings): New variable.
	(ssml.say-as.start): Set it.
	(ssml.say-as.end): Restore previous spelling mode.

2004-10-19  Milan Zamazal  <pdm@brailcom.org>

	* Version 0.4 released.

2004-07-29  Milan Zamazal  <pdm@brailcom.org>

	* Makefile (dist): Install all files names of which start with a
	capital letter.

2004-07-25  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-ssml): Apply synthesis on the utterance
	before eating it; return the last utterance.

2004-07-22  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-eat-utt): Don't use the Segment relation in
	wave eating, use the `pend' feature instead.

2004-07-20  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (utt-relation-top-items): New function.
	(do-relation-top-items): Use it.

2004-07-20  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm: Require ssml-mode.
	(speechd-refresh-modes): New function.
	(speechd-set-punctuation-mode, speechd-speak-ssml*): Ensure
	ssml-change-voice is wrapped.
	(ssml-change-voice): New wrapper.

2004-07-19  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-eat-utt): Don't use segments directly, create
	completely new items for the Event relation.

2004-07-19  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-speak-chunks, ssml-say*): New functions.

2004-07-18  Milan Zamazal  <pdm@brailcom.org>

	* multiwave.scm (multi-next): Use event-eat-utt.

	* events.scm (event-eat-utt): New function.
	(event-synth-text, event-synth-ssml): Use it.

2004-07-02  Milan Zamazal  <pdm@brailcom.org>

	* Version 0.3 released.

2004-07-01  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-character*, speechd-key*)
	(speechd-speak*): Recode the input text.

2004-07-01  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-next-chunk): Always recode, not only on
	language change.

2004-07-01  Milan Zamazal  <pdm@brailcom.org>

	* fileio.scm (read-file): Don't crash on an empty file.

2004-07-01  Milan Zamazal  <pdm@brailcom.org>
	
	* ssml-mode.scm (ssml-utt-text): Don't recode at all.
	(ssml-next-chunk): Many mark text processing fixes.

2004-07-01  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-utt-text): Call recoding only once, not
	inside the loop.

2004-06-30  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-process-words): Loop only through
	top relation items when deleting words.

	* util.scm (do-relation-top-items): New macro.

2004-06-30  Milan Zamazal  <pdm@brailcom.org>
	
	* punctuation.scm (punctuation-process-words): When removing
	punctuation, check tokens too.

2004-06-30  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml_init_func): Don't call reset-voice.

2004-06-29  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-set-prosody): Use change-prosody.
	(ssml-change-voice, ssml-unchange-voice): Call restore-prosody.

2004-06-29  Milan Zamazal  <pdm@brailcom.org>
	
	* prosody-param.scm (change-prosody): Return the old value.

2004-06-29  Milan Zamazal  <pdm@brailcom.org>
	
	* speech-dispatcher.scm (speechd-set-lang-voice): Call
	restore-prosody.
	(speechd-set-rate, speechd-set-pitch): Use change-prosody.

2004-06-29  Milan Zamazal  <pdm@brailcom.org>

	* prosody-param.scm (prosody-parameters): New variable.
	(change-prosody, restore-prosody, reset-prosody): New parameters.

2004-06-27  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-utt-text): Merge all unprocessed tokens.

2004-06-25  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-send-to-client): If WAVE is a
	symbol, just return it, don't send it explicitly.

2004-06-23  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-next-chunk): If utterance in the utterance
	list is a string, convert it to a symbol.

2004-06-23  Milan Zamazal  <pdm@brailcom.org>

	* fileio.scm (write-file): Convert STRING to a string if it is
	actually a symbol.

	* ssml-mode.scm (ssml-attval): Don't recode if ATT is nil.

2004-05-30  Milan Zamazal  <pdm@brailcom.org>

	* spell-mode.scm: Missing require util added.

2004-05-28  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-attval, ssml-utt-text): Recode the text
	string from UTF-8 to the current voice coding.

2004-05-27  Milan Zamazal  <pdm@brailcom.org>

	* recode.scm (recode-utf8->current): Extract voice coding
	properly; don't recode if the voice coding is utf-8.

2004-05-26  Milan Zamazal  <pdm@brailcom.org>

	* fileio.scm (with-temp-file-data): Typo fixed.

	* recode.scm: New module.

2004-05-14  Milan Zamazal  <pdm@brailcom.org>

	* fileio.scm: New module.

2004-05-13  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (current-voice-coding): New function.
	* speech-dispatcher.scm (speechd-set-lang-voice): Use it.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* Version 0.2 released.

2004-05-10  Milan Zamazal  <pdm@brailcom.org>

	* Makefile (dist): Set permissions of DISTDIR.

2004-05-04  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-ssml): Ignore symbols returned by
	ssml-next-chunk, don't crash on them.

2004-05-04  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-next*): Don't enable backtrace;
	protect against single mode invocation.

2004-05-04  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-send-to-client, speechd-next*):
	Handle symbols.

	* multiwave.scm (multi-next): Handle symbols from ssml-next-chunk.

	* ssml-mode.scm (ssml-next-chunk): Return markers as symbols.

2004-05-04  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-speak-ssml): Identifier typo
	fixed.

2004-05-04  Milan Zamazal  <pdm@brailcom.org>
	
	* ssml-mode.scm (ssml-process-mark): New function.
	(ssml.mark): Use it.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-plain): event-synth-1 call arguments
	fixed.
	(event-synth-plain): Parentheses typo fixed.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>
	
	* speech-dispatcher.scm (speechd-set-voice): Don't give language
	as the speechd-set-lang-voice argument.
	(speechd-set-lang-voice): Don't call reset-voice, set some
	select-voice* arguments to t instead.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-lang-voice): Return voice
	coding, not its name.

2004-04-30  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-voice-parameters): New variable.
	(ssml-change-voice, ssml-unchange-voice): Store and restore
	voice-select-current-defaults.

2004-04-30  Milan Zamazal  <pdm@brailcom.org>

	* multiwave.scm (multi-ssml-processing): New variable.
	(multi-clear, multi-synth, multi-next): Support SSML.

	* speech-dispatcher.scm (speechd-speak-ssml*)
	(speechd-speak-ssml): New functions.

2004-04-30  Milan Zamazal  <pdm@brailcom.org>
	
	* events.scm (event-synth-ssml): New function.
	(event-synth-plain): Support `ssml' events.

2004-04-30  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm (ssml-synth): Renamed to ssml-say.
	(ssml-parse): Honor the previous change.

2004-04-27  Milan Zamazal  <pdm@brailcom.org>

	* oo.scm (oo-glet-stack): New variable.
	(glet): New macro.
	(oo-push-let-value, oo-pop-let-value): New functions.

	* ssml-mode.scm (ssml-synth, ssml-parse): New functions.
	(ssml-tags, ssml-parsed, ssml-elements-parsing): New variables.
	(ssml-elements): Renamed to ssml-elements-speaking.
	(ssml-elements): New variable.
	(ssml-new-utterance, ssml-next-chunk, ssml-utt-text): New
	functions.
	(ssml-utterances): New variable.

	* util.scm (with-temp-file): New function.

2004-04-22  Milan Zamazal  <pdm@brailcom.org>

	* ssml-mode.scm: New file.

	* prosody-param.scm (prosody-shifted-value): New function.
	(prosody-change-parameter): New arguments `min' and `max'.
	(set-pitch, set-pitch-range, set-volume, set-rate): Set the min
	and max values.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-lang-voice): Return the
	selected voice name, not its pitch.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>
	
	* voice-select.scm (voice-list): Rewritten, to include voices from
	voice.list.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>

	* prosody-param.scm (prosody-adjust-volume): New function.
	(prosody-set-volume): Add it to after_synth_hooks.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-pitch-vars): Removed.
	(speechd-set-rate, speechd-set-pitch): Rewritten to use new
	prosody parameter functions.
	(speechd-current-voice): New variable.

	* util.scm (avalue-set!): New function.

	* prosody-param.scm: New file.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>

	* voice-select.scm (voice-list): New function.
	(select-voice, current-language-voices): Use it instead of
	voice.list.

2004-04-20  Milan Zamazal  <pdm@brailcom.org>

	* voice-select.scm (current-language-voices): New function.
	(voice-select-code-language, select-voice*) 
	(select-voice-internal): Bug fixes.

	* speech-dispatcher.scm (speechd-languages)
	(speechd-language-voices): Removed.
	(speechd-set-lang-voice, speechd-set-language)
	(speechd-list-voices): Rewritten to use voice-select functions.

2004-04-19  Milan Zamazal  <pdm@brailcom.org>
	
	* voice-select.scm: New file.

	* util.scm (remove-if, avalue-get): New functions.

2004-04-13  Milan Zamazal  <pdm@brailcom.org>

	* tokenize.scm (max-number-of-tokens, max-number-of-token-chars):
	New variables.
	(get-token, next-chunk): Honor them.

2004-04-13  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm: Require multiwave.
	(speechd-next, speechd-next*, speechd-enable-multi-mode): New
	functions.
	(speechd-multi-mode): New variable.
	(speechd-event-synth): New function.
	(speechd-speak*, speechd-spell*, speechd-sound-icon*)
	(speechd-character*, speechd-key*): Use it.
	(speechd-maybe-send-to-client): New function.
	(speechd-speak, speechd-spell, speechd-sound-icon) 
	(speechd-character, speechd-key): Use it.

2004-04-13  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-send-to-client): Set Wavefiletype
	here, not at the toplevel.

2004-04-13  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-send-to-client): Don't support
	list results anymore.

2004-04-08  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth): Renamed to event-synth-1.
	(event-synth): New function.
	(event-synth-1, event-synth-plain, event-synth-sound) 
	(event-synth-character, event-synth-key, event-synth-text): New
	argument wave-eater.
	(event-synth-text): Always return utt.

	* multiwave.scm: New file.

2004-04-06  Milan Zamazal  <pdm@brailcom.org>

	* tokenize.scm: New file.

2004-04-06  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (complement): New function.

2004-04-04  Milan Zamazal  <pdm@brailcom.org>

	* wave.scm (wave-load, wave-import-utt): New functions.

	* events.scm (event-synth-sound): Use wave-import-utterance.

2004-04-04  Milan Zamazal  <pdm@brailcom.org>

	* wave.scm (wave-subwave): Use make-temp-filename.

	* util.scm (dirname, make-temp-filename): New functions.

2004-04-01  Milan Zamazal  <pdm@brailcom.org>

	* cap-signalization.scm (token_to_words): Add event-stick-to
	feature.
	* word-mapping.scm (Word_Method): Likewise.

	* wave.scm (wave-subwave): Ensure the trimmed part has non-zero
	length.

	* events.scm (Pause_Method): Removed.
	(event-synth-text): Perform the Event relation creation previously
	done by Pause_Method; don't put pauses around events; honor the
	event-stick-to feature.
	(event-find-seg, event-find-seg-1): New functions.

2004-04-01  Milan Zamazal  <pdm@brailcom.org>

	* nopauses.scm: New file.

	* oo.scm (oo-unwrapped): New function.

2004-03-31  Milan Zamazal  <pdm@brailcom.org>

	* wave.scm (wave-concat): Concat the waveforms in the opposite
	order.

2004-03-30  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (Pause_Method): Be more careful about the event
	segment at the beginning of the utterance; put event on the last
	silence segment before the event word.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-process-words): Argument of
	word-mapping-of fixed.

	* events.scm (Pause_Method): Typo in insert_pause call fixed.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (avg): New function.

	* events.scm (Pauses): New wrapper.
	(event-synth-text): Completely rewritten.
	(event-synth-words, event-rest-of-synth, event-split-items) 
	(event-split-items-1): Removed.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (do-items): Renamed to dolist.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* word-mapping.scm (Word_Method): Use the new macros.
	* spell-mode.scm (spell-pos): Likewise.
	* events.scm (event-synth-words, event-synth-text): Likewise.
	* punctuation.scm (punctuation-process-words, Word_Method): Likewise.

	* util.scm (do-items, do-relation-items): New macros.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-text): Honor the change below.
	(event-synth-text): Use wave-utt.

	* util.scm (concat-waves): Moved to wave.scm and renamed to
	wave-concat.

	* wave.scm: New file.

2004-03-28  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm: Require word-mapping.
	(punctuation-process-words): Use word-mapping-of.
	(punctuation-split-token): Don't substitute
	punctuation-pronounciation characters; other simplifications.
	(Word_Method): Code simplified.

2004-03-28  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-process-final-punctuation):
	Removed.
	(Token_Method): Honor the previous change.

2004-03-28  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (word-mapping): Moved to word-mapping.scm.
	(event-mark-items): Removed.
	(event-synth-text): Don't call it.

	* word-mapping.scm: New file.

2004-03-28  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-pronunciation): Right brace item
	fixed.

2004-03-25  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (character-event-mapping): Use escape sequences
	instead of direct key ASCII codes.

2004-03-09  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-base-pitch): New variable.
	(speechd-set-lang-voice): Reset its value.
	(speechd-set-pitch): Completely rewritten.

2004-03-09  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-rate): Use uniform interval
	transformation formula.

2004-02-18  Milan Zamazal  <pdm@brailcom.org>

	* cap-signalization.scm (token_to_words): Dangling reference to
	cap-token-to-words fixed.

2004-02-02  Milan Zamazal  <pdm@brailcom.org>

	* Version 0.1 released.

2004-01-30  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-pitch): Support
	int_general_params.

2004-01-23  Milan Zamazal  <pdm@brailcom.org>

	* oo.scm (oo-wrapped-var): New function.
	(oo-ensure-function-wrapped): Make necessary precautions for case
	of function variable change.
	(oo-set-wrapper-func): Renamed to oo-set-wrapper-func!.

2004-01-23  Milan Zamazal  <pdm@brailcom.org>

	* Makefile (VERSION, DISTDIR, TARBALL): New variables.
	(dist): Implemented.
	(clean): Remove distdir.

2004-01-22  Milan Zamazal  <pdm@brailcom.org>

	* oo.scm (oo-wrappers-var, oo-ensure-function-wrapped): New
	functions.
	(define-wrapper): Use them.

	* util.scm (apply*): New function.

	* ttw.scm: Removed.

	* cap-signalization.scm: Use oo.scm instead of ttw.scm.
	* punctuation.scm: Likewise.
	(punctuation-process-words): Check for string form of the Language
	parameter too.

2004-01-22  Milan Zamazal  <pdm@brailcom.org>
	
	* festival-freebsoft-utils.texi (oo.scm): Parameter wrapping
	documented.

	* oo.scm (oo-last-wrapper-func): New function.
	(oo-param-wrappers-var, Param.wrap): New functions.
	(Param.get): New wrapper.

2004-01-21  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-process-words): Use Param.set, not
	Parameter.set.
	
	* speech-dispatcher.scm: Likewise.

2004-01-21  Milan Zamazal  <pdm@brailcom.org>

	* festival-freebsoft-utils.texi (oo.scm): Documented.

	* oo.scm: New file.

2004-01-21  Milan Zamazal  <pdm@brailcom.org>

	* festival-freebsoft-utils.texi (util.scm): Document let*.

	* util.scm (let*): New macro.
	(let*-bindings): New function.

2004-01-21  Milan Zamazal  <pdm@brailcom.org>

	* spell-mode.scm (mode, orig-mode): Removed.
	(spell_init_func, spell_exit_func): Honor the previous change.

2004-01-07  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (assoc-set): Cons the value, don't put it as a list.	
	* speech-dispatcher.scm (speechd-set-pitch): Honor the previous
	change.

	* events.scm (event-synth-result-format): Removed.
	(set-event-mapping!): New function.

2003-12-22  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-language-voices): Change czech
	voice to voice_czech_mbrola_cz2.

2003-11-27  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-language-voices): Don't define
	encodings.
	(speechd-languages, speechd-language-voices): Use symbols rather
	than strings.
	(speechd-set-lang-voice): Get the coding from the voice
	description.

2003-11-26  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-set-pitch): Be more clean;
	support `simple' intonation method.

	* util.scm (assoc-set): New function.

2003-11-20  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-language-voices): Coding added to
	voices.
	(speechd-set-lang-voice): Return language coding.

	* util.scm (third): New function.

2003-11-12  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-mark-items, event-synth-plain): Honor language
	dependent variable values.
	* util.scm (langvar): New function.

2003-11-11  Milan Zamazal  <pdm@brailcom.org>

	* speech-dispatcher.scm (speechd-languages) 
	(speechd-language-voices): German added.

2003-11-07  Milan Zamazal  <pdm@brailcom.org>

	* spell-mode.scm (spell-orig-pos-method): New variable.
	(spell-pos): New function.
	(spell_init_func, spell_exit_func): Set the POS_Method parameter.

2003-11-03  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (logical-event-mapping): New default value.
	(key-event-mapping): Likewise.

2003-10-24  Milan Zamazal  <pdm@brailcom.org>

	* punctuation.scm (punctuation-split-token) 
	(punctuation-process-words): Ensure a character from
	punctuation-pronunciation remains unexpanded if it is in
	word-mapping as well.

	* events.scm (event-synth): Call set_backtrace.
	(character-event-mapping): Definitions for basic control
	characters added.
	(event-print): New function.
	(event-synth): Use it.

2003-10-23  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-words): Don't append to token if there
	is none.

2003-10-17  Milan Zamazal  <pdm@brailcom.org>

	* util.scm (unwind-protect*): New macro.

	* events.scm (event-debug): New variable.
	(event-synth): Print debugging information.
	(event-synth-plain): Don't synth unknown logical events starting
	with underscore.
	(event-synth): Support for special logical events added.
	(event-synth-text): Don't fail on an empty text.
	(event-with-mode): New macro.
	(event-synth-plain): Set capital character signalization for key
	and character events.
	(event-synth-key, event-synth-character): New functions.
	(event-synth-plain): Use them.

2003-10-15  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-sound): New function.
	(synth-event-plain): Use it.  Say logical event name if its
	translation is not defined.
	(synth-event-result-format): Renamed to event-synth-result-format.
	(synth-event-plain): Renamed to event-synth-plain.
	(synth-event): Renamed to event-synth.
	(play-event): Renamed to event-play.
	* speech-dispatcher.scm: Consider the previous changes.

2003-10-11  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (sound-icons-directory): New variable.
	(logical-event-mapping): Allow relative pathnames of sound icons.
	New value.
	(synth-event-plain): Support relative sound file names.
	(word-mapping): Value changed.

2003-10-10  Milan Zamazal  <pdm@brailcom.org>

	* events.scm (event-synth-words): Create a real token in the new
	utterance and link the word item to it.
	(event-rest-of-synth): Call after_synth_hooks.

	* punctuation.scm (punctuation-process-english-words): Renamed to
	punctuation-process-words.  Handle stealth punctuation words in
	all languages when punctuation mode is none.
	(punctuation-character): New function.
	(punctuation-split-token): Use it.

